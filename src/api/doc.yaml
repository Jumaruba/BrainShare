openapi: 3.0.0
servers:
  # Added by API Auto Mocking Plugin
  - description: SwaggerHub API Auto Mocking
    url: https://virtserver.swaggerhub.com/lbaw2152/Brainshare/1.0.0
  - description: Website production server.
    url: lbaw2152-piu.lbaw-prod.fe.up.pt/
info:
  version: "1.0.0"
  title: Brainshare API
  description: Web resources specification for Brainshare

# Missing servers: Professor? 

# Add the url later. 
externalDocs: 
  description: It's possible to find more information here.  
  url: 


tags:
  - name: 'M01: Authentication and User Profile'
  - name: 'M02: Questions' 
  - name: 'M03: Management'
  - name: 'M04: Static Pages' 
  
paths:

#############
# REDIRECTS # 
############# 

########################################
# M01: Authentication and User Profile #
########################################


  /login:
    get:
      operationId: R101
      summary: "R101: Login form"
      description: "Provides the login form. Access: PUB"
      tags: 
        - 'M01 - Authentication and User Profile'
      responses:
        "200":
          description: "OK. Show the [UI06](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui06-login)" 

    post:
      operationId: R102
      summary: "R102: Login Action"
      description: "Proccesses the login action. Access: PUB"  
      tags:  
        - 'M01 - Authentication and User Profile'

      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                email:
                  type: string
                password:
                  type: string
              required:
                - email
                - password

      responses:
        "302":
          description: "Redirected. Login credentials processed."
          headers:
            Location:
              schema:
                type: string
              examples:
                302Success:
                  description: "Success authetication. Redirected to the questions page."
                302Error:
                  description: "Failed authetication. Redirected to the login page form."
                  value: "/login"

  /logout:
    post:
      operationId: R103
      summary: "R103: Logout Action"
      description: "Logout the current authenticated user. Access: USR, MOD, ADM"
      tags:  
        - 'M01 - Authentication and User Profile'
      
      responses:
        "302":
          description: "Redirect to the home page after logout. "
          headers:
            Location:
              schema:
                type: string
              examples:
                302Success:
                  description: "Successful logout. Redirected to the home page."

  /register:
    get:
      operationId: R104
      summary: "R104: Register form"
      description: "Provide the form for the user registration. Access: PUB"
      tags:  
        - 'M01 - Authentication and User Profile'
      responses:
        "200":
          description: "OK. Show the [UI07](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui07-register)"

    post:
      operationId: R105
      summary: "R105: Register Action"
      description: "Process the register form" 
      tags:  
        - 'M01 - Authentication and User Profile'

      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                username:
                  type: string
                email:
                  type: string
                password:
                  type: string
                image:
                  type: string
                  format: binary

              required:
                - username
                - email
                - password
      responses:
        "302":
          description: "Redirect after user register form has been processed."

          headers:
            Location:
              schema:
                type: string
              examples:
                # does it need to have a value in the success?
                302Success:
                  description: "Successful authentication. Redirect to the questions page."
                  value: "/search"
                302Error:
                  description: "Failed authentication. Redirect to the login page."
                  value: "/login"

  /user/{id}:
    get:
      operationId: R106
      summary: "R106: View the user profile"
      description: "Show the profile of a user. Access: USR"
      tags:  
        - 'M01 - Authentication and User Profile'

      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true

      responses:
        "404": 
          description: "Error. Id not found."
        "200":
          description: "OK. Show [UI05](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui05-profile)"

          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: string
                  email:
                    type: string
                  birthday:
                    type: string
                  courses:
                    type: array
                    items:
                      type: object
                      items: 
                        id:  
                          type: integer  
                        name:  
                          type: string  
                        date:  
                          type: string 
                  tags:
                    type: array
                    items:
                      type: object  
                      items: 
                        id:  
                          type: integer  
                        name:  
                          type: string  
                        date:  
                          type: string 

              example:
                name: "joaquina"
                email: "up201800123@fe.up.pt"
                birthday: "09/02/1997"
                courses: [
                  {
                    id: "1",
                    name: "MIEIC", 
                    date: "12/04/2020" 
                  },
                  {
                    id: "2", 
                    name: "MIEEC",
                    date: "12/05/2020" 
                  }
                ]
                tags: [                 
                 {
                    id: "1",
                    name: "c++", 
                    date: "03/04/2020" 
                  },
                  {
                    id: "2", 
                    name: "php",
                    date: "04/05/2020" 
                  }
                ] 

      update:
        operationId: R107
        summary: "R107: Update a user profile."
        description: "Update the user profile information. Access: OWN."
        tags:  
        - 'M01 - Authentication and User Profile'

        parameters:
          - in: path
            name: id
            schema:
              type: integer
            required: true

        requestBody:
          required: true
          content:
            application/x-www-form-urlencoded:
              schema:
                type: object
                properties:
                  name:
                    type: string
                  email:
                    type: string
                  birthday:
                    type: string
                  about:
                    type: string
                  course:
                    type: object
                    items:
                      id:
                        type: string
                      name:
                        type: string
                      date:
                        type: string
                  tags:
                    type: object
                    items:
                      id:
                        type: string
                      name:
                        type: string
                      date:
                        type: string

              response:
                "200":
                  description: "OK. Update succeded."
                "404":
                  description: "Error. Id not found."

      delete:
        operationId: R108
        summary: "R108: Deletes a user profile."
        description: "Update the user profile information. Access: OWN."
        tags:  
        - 'M01 - Authentication and User Profile'

        response:
          "200":
            description: "OK. Update succeded."
          "404":
            description: "Error. Id not found." 


  # Notification  

  /notification/{id}:
    get:
      operationId: "R109"
      summary: "R109: View a Notification"
      description: "Shows the Notification. Access: USR"
      tags:  
        - 'M01 - Authentication and User Profile'

      parameters:
        -in: path
        name: id
        schema:
          type: integer
          required: true

      responses:
        "200":
          description: "Ok, show [UI14](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui14-notifications)"
        "404":
          description: "Couldn't find notification ID, show [UI15](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui15-error-page)"

        content:
          application/json:
            schema:
              type: "object"
            properties:
              date:
                type: string
              viewed:
                type: boolean

          example:
            date: "09/01/2021"
            viewed: false

      delete:
        operationId: "R110"
        summary: "R110: Delete a Notification"
        description: "Deletes a Notification. Access: USR"
        tags:  
        - 'M01 - Authentication and User Profile'

        parameters:
          - in: path
            name: "id"
            schema:
              type: integer
            required: true

        response:
          "200":
            description: "Sucessfully deleted notification."

      update:
        operationId: R111
        summary: "R111: Update a Notification"
        description: "Updates a Notification, marking it as read. Access: USR"
        tags:  
          - 'M01 - Authentication and User Profile'


        parameters:
          - in: path
            schema:
              type: integer
            required: true

        response:
          "200":
            description: "Sucessfully updated notification"   
   
#################
# M02 Questions #
#################

  # TODO: search 

  /question/{id}:
    get:
      operationId: R201
      summary: "R201: View a question"
      description: "Shows the question. Access: PUB"
      tags:  
        - 'M02 - Questions'
      
      parameters:
        - in: path
          name: "id"
          schema:
            type: integer
          required: true

      responses:
        "200":
          description: "Ok. Show the [UI03](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui03-question)"

          content:
            application/json:
              schema:
                type: object
                properties:
                  title:
                    type: string
                  text:
                    type: string
                  publication:
                    type: string
                  author_username:
                    type: string
                  courses:
                    type: object
                    items:
                      id:  
                        type: integer 
                      name:  
                        type: string 
                      date:  
                        type: string 
                  tags:
                    type: object
                    items:
                      id:  
                        type: integer 
                      name:  
                        type: string 
                      date:  
                        type: string 

                  votes:
                    type: integer

              example:
                title: "How to solve this problem?"
                text: "I have no idea how to solve this problem"
                publication: "12/10/2020"
                author_username: "joaquina123"
                courses: [
                  {
                    id: "1",
                    name: "MIEIC", 
                    date: "12/04/2020" 
                  },
                  {
                    id: "2", 
                    name: "MIEEC",
                    date: "12/05/2020" 
                  }
                ]
                tags: [
                 {
                    id: "1",
                    name: "c++", 
                    date: "03/04/2020" 
                  },
                  {
                    id: "2", 
                    name: "php",
                    date: "04/05/2020" 
                  }
                ]
                votes: 4

          "404":
            description: "Error. Id not found."

    update:
      operationId: R202
      summary: "R202: Update a question"
      description: "Update question. Access: OWN, ADM, MOD"
      tags:  
        - 'M02 - Questions'
      
      parameters:
        - in: path
          name: "id"
          schema:
            type: integer
          required: true

          requestBody:
            required: true
            content:
              application/x-www-form-urlencoded:
                schema:
                  type: object
                  properties:
                    title:
                      type: string
                    text:
                      type: string
                    courses:
                      type: array 
                      items: 
                        type: string
                    tags:
                      type: array 
                      items: 
                        type: string 
                 

              example:
                title: "How to solve this problem?"
                text: "I have no idea how to solve this problem"
                courses: ["MIEIC", "MIEEC"]
                tags: ["c++","php"]
                
          responses:
            "302":
              description: "Redirect after the update is processed."

            # What should be this redirect on fail? 
            headers:
              Location:
                schema:
                  type: string
                examples:
                  302Success:
                    description: "Successful, redirects to the question page."
                    value: "/question/{id}"
                  302Error:
                    description: "Failed update. Redirects to the same page."
                    value: "/question/{id}"
            
            "404":
              description: "Id not found."

    delete:
      operationId: R203
      summary: "R203: Delete a question"
      description: "Deletes a question. Access: OWN, ADM, MOD"
      tags:  
        - 'M02 - Questions'

      parameters:
        - in: path
          name: "id"
          schema:
            type: integer
          required: true

      responses:
        "302":
            description: "Redirect after the update is processed."

            headers:
              Location:
                schema:
                  type: string
                examples:
                  302Success:
                    description: "Successful, redirects back to the search page."
                    # TODO: change name after creating the search path
                    value: "/search"
                  302Error:
                    description: "Failed delete. Redirects to the same page."
                    value: "/question/{id}"

  /question/create:
    get: 
      operationId: "R203"
      summary: "R203: shows the create question page."
      description: "Create new question. Access: USR"
      tags:  
      - 'M02 - Questions'


      responses: 
        "200": 
          description: "Ok. Show the add question page [UI04](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui04-add-question)"


    post:
      operationId: "R204"
      summary: "R204: Question being processed."
      description: "Create new question. Access: USR"
      tags:  
      - 'M02 - Questions'
      
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                title:
                  type: string
                content:
                  type: string
                courses:
                  type: array
                  items:
                    type: string
                tags:
                  type: array
                  items:
                    type: string
                

              required:
                - title
                - content
                - date

        example:
          title: "Is it hard to program in C?"
          content: "I've been struggling to learn it. I don't know if I'm dumb or if it's really hard."
          courses: ["MIEIC", "MIEEC"]
          tags: ["c++", "php"]

      reponses:
        responses:
        "302":
            description: "Redirect after the question creation is processed."

            headers:
              Location:
                schema:
                  type: string
                examples:
                  302Success:
                    description: "Successful, redirects to the question page."
                    value: "/search"
                  302Error:
                    description: "Failed creation. Redirects to the same page."
                    value: "/question/create"

  /answer/{id}:
    get:
      operationId: R205
      summary: "R205: View an answer"
      description: "Shows the answer. Access: PUB"
      tags:  
      - 'M02 - Questions'
      
      parameters:
        - in: path
          name: "id"
          schema:
            type: integer
            required: true

      responses:
        "200":
          description: "Ok. Get the answer information."

        content:
          application/json:
            schema:
              type: "object"
            properties:
              content:
                type: string
              date:
                type: string
              author:
                type: string
              valid:
                type: boolean

          example:
            content: "Acho que água alcalina é básica"
            date: "10/07/2020"
            author: "Joaquina"
            valid: true 
            
   
        "404":
          description: "Error, Id not found"
          
    delete:
      operationId: R206
      summary: "R206: Delete an answer. "
      description: "Delete an answer. Access: OWN, ADM, MOD"
      tags:  
      - 'M02 - Questions'

      responses:
        "200":
          description: "OK. Your answer has being accepted."
        "404":
          description: "This id doesn't exist, show [UI15](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui15-error-page)"

  /answer/create:
    post:
      operationId: "R208"
      summary: "R208: Answer being processed."
      description: "Create new answer. Access: USR"
      tags:  
      - 'M02 - Questions' 

      # TODO: é necessário enviar o question id e o nsewr_owner id no request body, mesmo sabendo que já é informação da página
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                content:
                  type: string 

              required:
                - content

        example:
          content: "I think that C is easy. You're the one that is dumb."

        responses: 
          "202": 
            description: "Ok. Show the [UI03](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui03-question)"

  /comment/{id}:
    get:
      operationId: "R209" 
      summary: "R209: View a comment"
      description: "Shows the comment. Access: PUB"
      tags:  
      - 'M02 - Questions' 

      parameters:
        - in: path
          name: "id"
          schema:
            type: integer
            required: true
      responses:
        "202":
          description: "Ok. Get the comment information."

        content:
          application/json:
            schema:
              type: "object"
            properties:
              content:
                type: string
              date:
                type: string
              author:
                type: string

          example:
            content: "Claro que é básica, duh"
            date: "10/07/2020"
            author: "Joaquina123"

        "404":
          description: "Error. Id not found."

    delete:
      operationId: R210
      summary: "R210: Delete a comment"
      description: "Deletes a comment. Access: OWN, ADM, MOD"
      tags:  
      - 'M02 - Questions' 
      

      parameters:
        - in: path
          name: "id"
          schema:
            type: integer
          required: true

      responses:
        "200":
          description: "Ok. Request accepted to be processed."
        "404":
          description: "Error. Comment id not found. "

  /comment/create:
   post:
      operationId: "R211"
      summary: "R211: Comment being processed."
      description: "Create new comment. Access: USR"
      tags:  
      - 'M02 - Questions' 

      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                content:
                  type: string 

              required:
                - content

        example:
          content: "I think that C is easy. You're the one that is dumb."

        responses: 
          "202": 
            description: "Ok. Show the [UI03](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui03-question)" 

###################
# M03: Management #
###################

  # os dois ou só um? 
  /manageCourses: 
    get:
      # Mudar depois o número do R
      operationId: R301
      summary: "R301: View a Course"
      description: "Shows the course. Access: ADM, MOD"
      tags:
      - 'M03 - Management'

      parameters:
        -in: path
        name: id
        schema:
          type: integer
          required: true

      responses:
        "200":
          description: "Ok, Show [UI09](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui09-manage-categories)"

      content:
          application/json:
            schema:
              type: "array"
            properties:
              type: object 
              items:  
                id: 
                  type: integer
                name:
                  type: string
                date:
                  type: string

          example:
            [ 
              {
                id: 1,
                name: "MIEC",
                date: "17/07/2010"  
              }, 
              {
                id: 2,
                name: "MIEEC",
                date: "18/07/2010"  
              }
            ]

  /course/{id}:
    get:
      # Mudar depois o número do R
      operationId: R302
      summary: "R301: View a Course"
      description: "Shows the course. Access: PUB"
      tags:
      - 'M03 - Management'

      parameters:
        -in: path
        name: id
        schema:
          type: integer
          required: true

      responses:
        "200":
          description: "Ok, Show [UI09](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui09-manage-categories)"

        content:
          application/json:
            schema:
              type: "object"
            properties:
              name:
                type: string
              date:
                type: string

          example:
            name: "MIEC"
            date: "17/07/2010"

    delete:
      operationId: "R303"
      summary: "R303: Delete a course"
      description: "Deletes a course. Access: ADM, MOD"
      tags:
      - 'M03 - Management'


      parameters:
        - in: path
          name: "id"
          schema:
            type: integer
          required: true

      response:
        "200":
          description: "Delete Sucessful, show [UI09](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui09-manage-categories)"

  /course/create:
    post:
      opereationId: R304
      summary: "R304 : Course being processed."
      description: "Create new course. Access: ADM, MOD"
      tags:
      - 'M03 - Management'
        
      responses:
        "200":
          description: "Ok. Request accepted to be processed."
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                name:
                  type: string
              required:
                - name

        example:
          name: "MIEC"

  /tag/{id}:
    get:
      operationId: R305
      summary: "R305: View a Tag"
      description: "Shows the Tag. Access: PUB"
      tags:
      - 'M03 - Management' 

      parameters:
        -in: path
        name: id
        schema:
          type: integer
          required: true

      responses:
        "200":
          description: "Ok, Show [UI09](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui09-manage-categories)"

        content:
          application/json:
            schema:
              type: "object"
            properties:
              name:
                type: string
              date:
                type: string

          example:
            name: "Exam"
            date: "10/01/2012"

      delete:
        operationId: R306
        summary: "R306 - Delete a Tag"
        description: "Deletes a Tag. Access: ADM, MOD"
        tags:
        - 'M03 - Management'

        parameters:
          - in: path
            name: "id"
            schema:
              type: integer
            required: true

        response:
          "200":
            description: "Delete Sucessful"
          "404":
            description: "Couldn't find Tag ID, show [UI15](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui15-error-page)"

  /tag/create:
    post:
      opereationId: R307
      summary: "R307 : Course being processed."
      description: "Create new tag. Access: ADM, MOD"
      tags:
      - 'M03 - Management' 
      
      responses:
        "200":
          description: "Ok. Tag successfully added"

      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                name:
                  type: string
              required:
                - name

        example:
          name: "Exam"

# Report  

  /reports:
     get:
      # Mudar depois o número do R
      operationId: R308
      summary: "R308: View reports"
      description: "Shows the course. Access: ADM, MOD"
      tags:
      - 'M03 - Management'

      parameters: 
        -in: path
        name: id
        schema:
          type: integer
          required: true

      responses:
        "200":
          description: "Ok, Show Manage Reports [UI10](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui10-manage-reports)."

      content:
          application/json:
            schema:
              type: "array"
            properties:
              type: array 
              items: 
                type: object 
                items:  
                  id: 
                    type: integer
                  summary:
                    type: string
                  numberReports:
                    type: string 


          example:
            [ 
              {
                id: 1,
                summary: "joaquina123", 
                type: "user",
                date: "17/07/2010"  
              }, 
              {
                id: 2,
                name: "I can",
                date: "18/07/2010"  
              }
            ]

  /report/user/{id}: 
    operationId: "R308"
    summary: "R308 : Number of reports in a user."  
    description: "Retrieves the number of reports of a user. Access: ADM, MOD"
    tags:
      - 'M03 - Management'   

    parameters: 
      - in: path 
        userId: "id" 
        schema: 
          type: integer 
        required: true 
 
    responses: 
      "200": 
        description: "Ok. Retrieve the reports of user."   

      content: 
        application/json: 
          schema: 
            type: object 
            properties:  
              username: 
                type: string  
              numberReports:  
                type: integer   
        example: 
          username: "Joaquina" 
          numberReports: 12   

      "404": 
        description: "Error. This user doesn't exits" 
 
  /report/question/{id}:  
    operationId: --- 
    summary: "---: Number of reports of a question. " 
    description: "Retrieves the number of reports of a question. Access: ADM, MOD"  

    parameters: 
      - in: path 
        questionId: "id"  
        schema: 
          type: integer 
        required: true  

    responses:  
      "200": 
        description: "Ok. Retrieve the report of a question." 

      
        


  report/question/create: 
     

  /report/answer/{id}:   

  /report/answer/create:   

  /report/comment/{id}:
    get:
      operationId: ---
      summary: "---: View a Reported Comment"
      description: "Shows the Reported Comment. Access: ADM"

      parameters:
        -in: path
        name: id
        schema:
          type: integer
          required: true

      responses:
        #Is it 202? Check afterwards all
        "200":
          description: "Ok, Show [UI10](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui10-manage-reports)"
        "404":
          description: "Couldn't find notification ID, show [UI15](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui15-error-page)"

        content:
          application/json:
            schema:
              type: "object"
              properties:
                count:
                  type: integer

          example:
            id: "173"
            date: "12/03/2019"
            viewed: false
            count:  12

      update:
        operationId: ---
        summary: "---: Updates a Comment Report"
        description: "Updates a Report From the Comment Table. Access: MOD, ADM"
        parameters:
          - in: path
            name: "id"
            schema:
              type: integer
            required: true

        response:
          "200":
            description: "Ok, Show [UI10](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui10-manage-reports)"
          "404":
            description: "Couldn't find Tag ID, show [UI15](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui15-error-page)"

        requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                viewed:
                  type: string
                date:
                  type: string
          example: 
            viewed: "true" 
            date: 10/10/2010   

        

  /report/comment/create:  

##############
# BAN 
##############


#####################
# M04: Static Pages #
#####################

  /home:
    get:
      operationId: R401
      summary: "R401: View home page "
      description: "Shows the home page. Access: PUB"
      tags:
      - 'M04 - Static Pages'

      responses:
      "202":
        description: "Ok. Show the home page [UI01](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui01-home)." 


  /about:
    get:
      operationId: R402
      summary: "R402: View the about page "
      description: "Shows the about page. Access: PUB"
      tags:
      - 'M04 - Static Pages'

      responses:
      "202":
        description: "Ok. Show the home page [UI013](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui13-about)." 
    
      
      
  /error: 
    get:
      operationId: R402
      summary: "R402: View the error page. "
      description: "Shows the error page. Access: PUB"
      tags:
      - 'M04 - Static Pages'

      responses:
      "202":
        description: "Ok. Show the home page [UI015](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui15-error-page)." 