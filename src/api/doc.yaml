openapi: 3.0.0
servers:
  # Added by API Auto Mocking Plugin
  - description: SwaggerHub API Auto Mocking
    url: https://virtserver.swaggerhub.com/lbaw2152/Brainshare/1.0.0
  - description: Website production server.
    url: lbaw2152-piu.lbaw-prod.fe.up.pt/
info:
  version: "1.0.0"
  title: Brainshare API
  description: Web resources specification for Brainshare

paths:

####################
# REDIRECTS 
#################### 

  /login:
    get:
      operationId: R101
      summary: "R101: Login form"
      description: "Provides the login form. Access: PUB"
      responses:
        "200":
          description: "OK. Show the [UI06](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui06-login)" 

    post:
      operationId: R102
      summary: "R102: Login Action"
      description: "Proccesses the login action. Access: PUB"
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                email:
                  type: string
                password:
                  type: string
              required:
                - email
                - password

      responses:
        "302":
          description: "Redirected. Login credentials processed."
          headers:
            Location:
              schema:
                type: string
              examples:
                302Success:
                  description: "Success authetication. Redirected to the questions page."
                302Error:
                  description: "Failed authetication. Redirected to the login page form."
                  value: "/login"

  /logout:
    post:
      operationId: R103
      summary: "R103: Logout Action"
      description: "Logout the current authenticated user. Access: USR, MOD, ADM"

      responses:
        "302":
          description: "Redirect to the home page after logout. "
          headers:
            Location:
              schema:
                type: string
              examples:
                302Success:
                  description: "Successful logout. Redirected to the home page."

  /register:
    get:
      operationId: R104
      summary: "R104: Register form"
      description: "Provide the form for the user registration. Access: PUB"

      responses:
        "200":
          description: "OK. Show the [UI07](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui07-register)"

    post:
      operationId: R105
      summary: "R105: Register Action"
      description: "Process the register form"
      # browser submete informação de forma nativa., 
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                username:
                  type: string
                email:
                  type: string
                password:
                  type: string
                image:
                  type: string
                  format: binary

              required:
                - username
                - email
                - password
      responses:
        "302":
          description: "Redirect after user register form has been processed."

          headers:
            Location:
              schema:
                type: string
              examples:
                # does it need to have a value in the success?
                302Success:
                  description: "Successful authentication. Redirect to the questions page."
                302Error:
                  description: "Failed authentication. Redirect to the login page."
                  value: "/login"

  /user/{id}:
    get:
      operationId: R106
      summary: "R106: View the user profile"
      description: "Show the profile of a user. Access: USR"

      parameters:
        - in: path
          name: id
          schema:
            type: integer
          required: true

      responses:
        "202":
          description: "OK. Show [UI05](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui05-profile)"

          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  name:
                    type: string
                  email:
                    type: string
                  birthday:
                    type: string
                  courses:
                    type: array
                    items:
                      type: string
                  tags:
                    type: array
                    items:
                      type: string

              example:
                id: "1"
                name: "joaquina"
                email: "up201800123@fe.up.pt"
                birthday: "09/02/1997"
                courses: ["MIEIC", "MIEB"]
                tags: ["c++", "php"]

      # TODO: can be the update be inside of the same path?
      update:
        operationId: ---
        summary: "---: Update a user profile."
        description: "Update the user profile information. Access: OWN."

        parameters:
          - in: path
            name: id
            schema:
              type: integer
            required: true

        requestBody:
          required: true
          # Why some of them is x-www-form and others are json?
          content:
            application/x-www-form-urlencoded:
              schema:
                type: object
                properties:
                  name:
                    type: string
                  email:
                    type: string
                  birthday:
                    type: string
                  about:
                    type: string
                  # TODO: for this object do we need to specify it?
                  course:
                    type: object
                    items:
                      id:
                        type: string
                      name:
                        type: string
                      date:
                        type: string
                  tags:
                    type: object
                    items:
                      id:
                        type: string
                      name:
                        type: string
                      date:
                        type: string

              response:
                "200":
                  description: "OK. Update succeded."
                "404":
                  description: "Error. Id not found."

  /question/{id}:
    get:
      operationId: R107
      summary: "R107: View a question"
      description: "Shows the question. Access: PUB"

      parameters:
        - in: path
          name: "id"
          schema:
            type: integer
          required: true

      responses:
        "200":
          description: "Ok. Show the [UI03](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui03-question)"

          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  title:
                    type: string
                  text:
                    type: string
                  publication:
                    type: string
                  author_username:
                    type: string
                  courses:
                    type: array
                    items:
                      type: string
                  tags:
                    type: array
                    items:
                      type: string
                  votes:
                    type: integer

              example:
                id: "1"
                title: "How to solve this problem?"
                text: "I have no idea how to solve this problem"
                publication: "12/10/2020"
                author_username: "joaquina123"
                # is this ok?
                course: [Course, ...]
                tags: [Tags, ...]
                votes: 4

          "404":
            description: "Error. Question not found."

    update:
      operationId: ---
      summary: "---: Update a question"
      description: "Update question. Access: OWN, ADM, MOD"
      # do we need to put the operators for every.
      parameters:
        - in: path
          name: "id"
          schema:
            type: integer
          required: true

      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                title:
                  type: string
                content:
                  type: string
                courses:
                  type: object
                tags:
                  type: object 
      # meter certo 
      example:
        title: "I don't know python. Is it hard?"
        content: "I would like to know if it's hard"
        courses: [Course, ...]
        tags: [Tag, ...]

        responses:
        "200":
          description: "Ok. Request accepted to be processed."
        "404":
          description: "Error. Question id not found. "

    # TODO: check the delete with the professor.
    # Is it here and are the responses correct?
    delete:
      operationId: ---
      summary: "---: Delete a question"
      description: "Deletes a question. Access: OWN, ADM, MOD"

      parameters:
        - in: path
          name: "id"
          schema:
            type: integer
          required: true

      responses:
        "200":
          description: "Ok. Request accepted to be processed."
        "404":
          description: "Error. Question id not found. "

  /question/create:
    post:
      operationId: ---
      summary: "---: Question being processed."
      description: "Create new question. Access: USR"

      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                title:
                  type: string
                content:
                  type: string
                date:
                  type: string
                tags:
                  type: array
                  items:
                    type: string
                courses:
                  type: array
                  items:
                    type: string

              required:
                - title
                - content
                - date

        example:
          title: "Is it hard to program in C?"
          content: "I've been struggling to learn it. I don't know if I'm dumb or if it's really hard."
          date: "25/12/2020"
          # TODO: Can we do that?
          tags: [Tag, ...]
          courses: [Course, ...]

      reponses:
        "200":
          description: "OK. Your question has been created."

  /answer/{id}:
    get:
      operationId: R109
      summary: "R108: View an answer"
      description: "Shows the answer. Access: PUB"

      parameters:
        - in: path
          name: "id"
          schema:
            type: integer
            required: true

      resposes:
        "202":
          # is this right?
          description: "Ok. Show the [UI03](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui03-question)"

        content:
          application/json:
            schema:
              type: "object"
            properties:
              id:
                type: string
              content:
                type: string
              date:
                type: string
              # is this a int?
              author:
                type: string
              valid:
                type: int

          example:
            id: "101"
            content: "Acho que água alcalina é básica"
            date: "10/07/2020"
            author: "Joaquina"
            valid: 1
    
    delete:
      operationId: ---
      summary: "---: Delete an answer. "
      description: "Delete an answer. Access: OWN, ADM, MOD"

      responses:
        "200":
          description: "OK. Your answer has being accepted."
          # TODO: Does is to redirect? How can it redirect?
        "404":
          description: "This id doesn't exist, show [UI15](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui15-error-page)"

    /comment/{id}:
      get:
        operationId: R109
        summary: "R108: View a comment"
        description: "Shows the comment. Access: PUB"

      parameters:
        - in: path
          name: "id"
          schema:
            type: integer
          required: true

      # TODO:Is it supposed to be 202 or 200?
      responses:
        "202":
          description: "Ok. Show the [UI03](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui03-question)"

        content:
          application/json:
            schema:
              type: "object"
            properties:
              id:
                type: string
              content:
                type: string
              date:
                type: string
              # is this a int?
              author:
                type: string

          example:
            id: "101"
            content: "Mas é claro que é alcalina, duh."
            date: "10/07/2020"
            author: "Joaquina42"

  /answer/create:
    post:
      operationId: ---
      summary: "---: Answer being processed."
      description: "Create new answer. Access: USR"

      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                content:
                  type: string
                date:
                  type: string

              required:
                - content
                - date

        example:
          content: "I think that C is easy. You're the one that is dumb."
          date: "25/12/2020"

  /comment/{id}:
    get:
      operationId: ---
      summary: "R108: View a comment"
      description: "Shows the answer. Access: PUB"

      parameters:
        - in: path
          name: "id"
          schema:
            type: integer
            required: true
      responses:
        "202":
          # is this right?
          description: "Ok. Show the [UI03](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui03-question)"

        content:
          application/json:
            schema:
              type: "object"
            properties:
              id:
                type: string
              content:
                type: string
              date:
                type: string
              # is this a int?
              author:
                type: string

          example:
            id: "101"
            content: "Claro que é básica, duh"
            date: "10/07/2020"
            author: "Joaquina123"

    delete:
      operationId: ---
      summary: "---: Delete a comment"
      description: "Deletes a comment. Access: OWN, ADM, MOD"

      parameters:
        - in: path
          name: "id"
          schema:
            type: integer
          required: true

      responses:
        "200":
          description: "Ok. Request accepted to be processed."
        "404":
          description: "Error. Comment id not found. "

  /course/{id}:
    get:
      # Mudar depois o número do R
      operationId: ---
      summary: "---: View a Course"
      description: "Shows the course. Access: PUB"

      parameters:
        -in: path
        name: id
        schema:
          type: integer
          required: true

      responses:
        #Is it 202? Check afterwards all
        "200":
          description: "Ok, Show [UI09](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui09-manage-categories)"

        content:
          application/json:
            schema:
              type: "object"
            properties:
              id:
                type: string
              name:
                type: string
              date:
                type: string

          example:
            id: "10"
            name: "MIEC"
            date: "17/07/2010"

        delete:
        operationId: ---
        summary: "---: Delete a course"
        description: "Deletes a course. Access: ADM, MOD"

        parameters:
          - in: path
            name: "id"
            schema:
              type: integer
            required: true

        response:
          "200":
            description: "Delete Sucessful, show [UI09](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui09-manage-categories)"
          "404":
            description: "Couldn't find course ID, show [UI15](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui15-error-page)"

  /course/create:
    post:
      opereationId: ---
      summary: "--- : Course being processed."
      description: "Create new course. Access: ADM, MOD"
      responses:
        "200":
          description: "Ok, Show [UI09](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui09-manage-categories)"
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                name:
                  type: string
              # Colocar o atributo date, que nunca é mandado mas fica com o default de now?
              required:
                - name

        example:
          name: "MIEC"
          date: "17/07/2020"

  /tag/{id}:
    get:
      #Mudar depois o número do R
      operationId: ---
      summary: "---: View a Tag"
      description: "Shows the Tag. Access: PUB"

      parameters:
        -in: path
        name: id
        schema:
          type: integer
          required: true

      responses:
        #Is it 202? Check afterwards all
        "200":
          description: "Ok, Show [UI09](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui09-manage-categories)"

        content:
          application/json:
            schema:
              type: "object"
            properties:
              id:
                type: string
              name:
                type: string
              date:
                type: string

          example:
            id: "50"
            name: "Exam"
            date: "10/01/2012"

      delete:
        operationId: ---
        summary: "---: Delete a Tag"
        description: "Deletes a Tag. Access: ADM, MOD"

        parameters:
          - in: path
            name: "id"
            schema:
              type: integer
            required: true

        response:
          "200":
            description: "Delete Sucessful, show [UI09](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui09-manage-categories)"
          "404":
            description: "Couldn't find Tag ID, show [UI15](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui15-error-page)"

  /tag/create:
    post:
      opereationId: ---
      summary: "--- : Course being processed."
      description: "Create new tag. Access: ADM, MOD"
      responses:
        "200":
          description: "Ok, Show [UI09](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui09-manage-categories)"

      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                name:
                  type: string
              # Colocar o atributo date, que nunca é mandado mas fica com o default de now?
              required:
                - name

        example:
          name: "Exam"

  ##################
  # Notification 
  ################## 

  /notification/{id}:
    get:
      operationId: ---
      summary: "---: View a Notification"
      description: "Shows the Notification. Access: USR"

      parameters:
        -in: path
        name: id
        schema:
          type: integer
          required: true

      responses:
        #Is it 202? Check afterwards all
        "200":
          description: "Ok, Show [UI14](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui14-notifications)"
        "404":
          description: "Couldn't find notification ID, show [UI15](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui15-error-page)"

        content:
          application/json:
            schema:
              type: "object"
            properties:
              id:
                type: string
              date:
                type: string
              viewed:
                type: boolean

          example:
            id: "7592"
            date: "9/01/2021"
            viewed: false

      delete:
        operationId: ---
        summary: "---: Delete a Notification"
        description: "Deletes a Notification. Access: USR"

        parameters:
          - in: path
            name: "id"
            schema:
              type: integer
            required: true

        response:
          "200":
            description: "Delete Sucessful, Show [UI14](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui14-notifications)"
          "404":
            description: "Couldn't find Tag ID, show [UI15](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui15-error-page)"

      update:
        operationId: ---
        summary: "---: Update a Notification"
        description: "Updates a Notification, marking it as read. Access: USR"

        parameters:
          - in: path
            name: "id"
            schema:
              type: integer
            required: true

        response:
          "200":
            description: "Sucessfully updated notification, Show [UI14](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui14-notifications)"
          "404":
            description: "Couldn't find Tag ID, show [UI15](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui15-error-page)"
  
  /notification/create:
    post:
      opereationId: ---
      summary: "--- : Notification being processed."
      description: "Create new notification. Access: USR"
      responses:
        "200":
          description: "Ok, Notification Added"

      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema: 
              type: object
              properties:
                date:
                  type: string
                viewed:
                  type: string
              # Colocar o atributo date, que nunca é mandado mas fica com o default de now?

        example:
          date: "11/02/2019"
          viewed: "false"

  ##################
  # REPORT 
  ################## 

  /report/user/{id}: 
    operationId: 
    summary: "--- : Number of reports in a user."  
    description: "Retrieves the number of reports of a user. Access: ADM, MOD"  

    parameters: 
      - in: path 
        userId: "id" 
        schema: 
          type: integer 
        required: true 
 
    responses: 
      "200": 
        description: "Ok. Retrieve the reports of user."   

      content: 
        application/json: 
          schema: 
            type: object 
            properties:  
              username: 
                type: string  
              numberReports:  
                type: integer   
        example: 
          username: "Joaquina" 
          numberReports: 12   

      "404": 
        description: "Error. This user doesn't exits" 
 
  /report/question/{id}:  
    operationId: --- 
    summary: "---: Number of reports of a question. " 
    description: "Retrieves the number of reports of a question. Access: ADM, MOD"  

    parameters: 
      - in: path 
        questionId: "id"  
        schema: 
          type: integer 
        required: true  

    responses:  
      "200": 
        description: "Ok. Retrieve the report of a question." 

      
        


  report/question/create: 
     

  /report/answer/{id}:   

  /report/answer/create:   

  /report/comment/{id}:
    get:
      operationId: ---
      summary: "---: View a Reported Comment"
      description: "Shows the Reported Comment. Access: ADM"

      parameters:
        -in: path
        name: id
        schema:
          type: integer
          required: true

      responses:
        #Is it 202? Check afterwards all
        "200":
          description: "Ok, Show [UI10](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui10-manage-reports)"
        "404":
          description: "Couldn't find notification ID, show [UI15](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui15-error-page)"

        content:
          application/json:
            schema:
              type: "object"
              properties:
                count:
                  type: integer

          example:
            id: "173"
            date: "12/03/2019"
            viewed: false
            count:  12

      update:
        operationId: ---
        summary: "---: Updates a Comment Report"
        description: "Updates a Report From the Comment Table. Access: MOD, ADM"
        parameters:
          - in: path
            name: "id"
            schema:
              type: integer
            required: true

        response:
          "200":
            description: "Ok, Show [UI10](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui10-manage-reports)"
          "404":
            description: "Couldn't find Tag ID, show [UI15](https://git.fe.up.pt/lbaw/lbaw2021/lbaw2152/-/wikis/ER#ui15-error-page)"

        requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                viewed:
                  type: string
                date:
                  type: string
          example: 
            viewed: "true" 
            date: 10/10/2010   

        

  /report/comment/create:  

##############
# BAN 
##############